<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>材料でレシピ検索</title>
    <style>
      body { font-family: Arial; padding: 20px; }
      label { display: block; margin: 5px 0; }
      button { margin-top: 10px; padding: 8px 12px; }
      .recipe { margin: 10px 0; }
    </style>
  </head>
  <body>
    <h2>材料でレシピ検索</h2>
    <p>材料を2つ以上選択してください：</p>

    <form id="materialForm">
      <label><input type="checkbox" name="material" value="牛肉"> 牛肉</label>
      <label><input type="checkbox" name="material" value="鶏肉"> 鶏肉</label>
      <label><input type="checkbox" name="material" value="豚肉"> 豚肉</label>
      <label><input type="checkbox" name="material" value="魚"> 魚</label>
      <label><input type="checkbox" name="material" value="卵"> 卵</label>
      <label><input type="checkbox" name="material" value="豆腐"> 豆腐</label>
      <label><input type="checkbox" name="material" value="根菜類"> 根菜類</label>
      <label><input type="checkbox" name="material" value="葉物野菜"> 葉物野菜</label>
      <label><input type="checkbox" name="material" value="果菜類"> 果菜類</label>
      <label><input type="checkbox" name="material" value="キノコ類"> キノコ類</label>
      <label><input type="checkbox" name="material" value="豆類"> 豆類</label>
      <br>
      <button type="button" onclick="searchRecipes()">検索</button>
    </form>

    <div id="results"></div>

    <script>
      function searchRecipes() {
        const checkboxes = document.querySelectorAll('input[name="material"]:checked');
        if (checkboxes.length < 2) {
          alert("2つ以上の材料を選択してください。");
          return;
        }
        const selected = Array.from(checkboxes).map(c => c.value);

        google.script.run.withSuccessHandler(displayResults).getRecipes(selected);
      }

      function displayResults(recipes) {
        const container = document.getElementById("results");
        container.innerHTML = "";

        if (recipes.length === 0) {
          container.innerHTML = "<p>該当するレシピが見つかりませんでした。</p>";
          return;
        }

        recipes.forEach(r => {
          const div = document.createElement("div");
          div.className = "recipe";
          div.innerHTML = `<a href="${r.url}" target="_blank">${r.title}</a>`;
          container.appendChild(div);
        });
      }
    </script>
  </body>
</html>
